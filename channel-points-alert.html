<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Channel Points Alert</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html, body {
    width: 100vw;
    height: 100vh;
    background: transparent;
    overflow: hidden;
    position: relative;
  }

  .coin-alert {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    opacity: 0;
    pointer-events: none;
  }

  .coin-container {
    width: 320px;
    height: 320px;
    position: relative;
    perspective: 1000px;
  }

  /* Spring up and spin animation */
  @keyframes coinEntrance {
    0% {
      transform: translate(-50%, 100vh) scale(0.5) rotateY(0deg);
      opacity: 0;
    }
    30% {
      opacity: 1;
    }
    50% {
      transform: translate(-50%, -60%) scale(1.1) rotateY(540deg);
    }
    70% {
      transform: translate(-50%, -48%) scale(0.95) rotateY(900deg);
    }
    85% {
      transform: translate(-50%, -52%) scale(1.02) rotateY(1080deg);
    }
    100% {
      transform: translate(-50%, -50%) scale(1) rotateY(1080deg);
      opacity: 1;
    }
  }

  @keyframes fadeOut {
    0% {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
    100% {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.8);
    }
  }

  .coin-alert.active {
    animation: coinEntrance 1.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    opacity: 1;
  }

  .coin-alert.exit {
    animation: fadeOut 0.5s ease-out forwards;
  }

  /* Redemption text */
  .redemption-text {
    position: absolute;
    bottom: -50px;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    opacity: 0;
    animation: textFadeIn 0.5s ease-out 1s forwards;
  }

  @keyframes textFadeIn {
    0% {
      opacity: 0;
      transform: translateX(-50%) translateY(20px);
    }
    100% {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
  }

  .redemption-user {
    font-size: 36px;
    font-weight: 900;
    color: #8A38F5;
    text-shadow:
      -2px -2px 0 #000,
      2px -2px 0 #000,
      -2px 2px 0 #000,
      2px 2px 0 #000,
      0 0 20px #8A38F5,
      0 0 40px #8A38F5;
    margin-bottom: 10px;
    font-family: system-ui, -apple-system, sans-serif;
  }

  .redemption-reward {
    font-size: 26px;
    font-weight: 700;
    color: #ffffff;
    text-shadow:
      -2px -2px 0 #000,
      2px -2px 0 #000,
      -2px 2px 0 #000,
      2px 2px 0 #000;
    font-family: system-ui, -apple-system, sans-serif;
  }
</style>
</head>
<body>
  <div class="coin-alert" id="coin-alert">
    <div class="coin-container">
      <svg width="496" height="496" viewBox="0 0 496 496" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 100%; height: 100%;">
        <g clip-path="url(#clip0_44_62)">
        <g filter="url(#filter0_ii_44_62)">
        <circle cx="248" cy="248" r="248" fill="#8A38F5"/>
        </g>
        <circle cx="248" cy="248" r="242" stroke="#2C0F52" stroke-width="12"/>
        <g filter="url(#filter1_ddi_44_62)">
        <ellipse cx="247.5" cy="248" rx="199.5" ry="200" fill="#8A38F5"/>
        <path d="M247.5 54C354.353 54 441 140.843 441 248C441 355.157 354.353 442 247.5 442C140.647 442 54 355.157 54 248C54 140.843 140.647 54 247.5 54Z" stroke="#2C0F52" stroke-width="12"/>
        </g>
        <g filter="url(#filter2_i_44_62)">
        <g filter="url(#filter3_di_44_62)">
        <path d="M104.574 256.897L110.403 285.058C112.141 293.453 115.482 301.433 120.241 308.563L120.743 309.315C128.778 321.349 140.649 330.311 154.424 334.74L162.938 337.478C171.114 340.107 176.658 347.713 176.658 356.301V376.095C176.658 382.559 181.047 388.197 187.313 389.783C194.49 391.599 201.851 387.562 204.179 380.535L209.956 363.093C210.198 362.363 211.276 362.537 211.276 363.306V384.802C211.276 393.196 218.081 400 226.474 400C233.693 400 239.917 394.921 241.364 387.848L245.473 367.763C245.64 366.947 246.82 366.991 246.926 367.817L249.436 387.448C250.353 394.624 256.46 400 263.695 400C271.302 400 277.592 394.073 278.044 386.48L279.372 364.183C279.42 363.368 280.544 363.19 280.841 363.951L288.586 383.746C290.771 389.331 296.155 393.005 302.151 393.005C306.783 393.005 311.139 390.802 313.884 387.071L315.919 384.304C318.455 380.858 319.896 376.73 320.058 372.455L320.464 361.72C320.913 349.828 328.792 339.504 340.142 335.931L344.547 334.544C358.222 330.24 370.053 321.464 378.14 309.626C383.474 301.818 387.009 292.924 388.491 283.585L391.89 262.17C395.262 240.922 394.327 219.213 389.14 198.333L385.822 184.975C379.709 160.368 365.947 138.335 346.516 122.047C329.956 108.166 309.951 99.0222 288.618 95.584L273.414 93.1336C256.429 90.3961 239.111 90.4408 222.14 93.266L215.778 94.325C190.227 98.5785 166.415 110.019 147.128 127.31C125.005 147.141 109.942 173.758 104.266 202.92C100.798 220.735 100.895 239.125 104.574 256.897Z" fill="url(#innerContour)"/>
        <path d="M104.574 256.897L110.403 285.058C112.141 293.453 115.482 301.433 120.241 308.563L120.743 309.315C128.778 321.349 140.649 330.311 154.424 334.74L162.938 337.478C171.114 340.107 176.658 347.713 176.658 356.301V376.095C176.658 382.559 181.047 388.197 187.313 389.783C194.49 391.599 201.851 387.562 204.179 380.535L209.956 363.093C210.198 362.363 211.276 362.537 211.276 363.306V384.802C211.276 393.196 218.081 400 226.474 400C233.693 400 239.917 394.921 241.364 387.848L245.473 367.763C245.64 366.947 246.82 366.991 246.926 367.817L249.436 387.448C250.353 394.624 256.46 400 263.695 400C271.302 400 277.592 394.073 278.044 386.48L279.372 364.183C279.42 363.368 280.544 363.19 280.841 363.951L288.586 383.746C290.771 389.331 296.155 393.005 302.151 393.005C306.783 393.005 311.139 390.802 313.884 387.071L315.919 384.304C318.455 380.858 319.896 376.73 320.058 372.455L320.464 361.72C320.913 349.828 328.792 339.504 340.142 335.931L344.547 334.544C358.222 330.24 370.053 321.464 378.14 309.626C383.474 301.818 387.009 292.924 388.491 283.585L391.89 262.17C395.262 240.922 394.327 219.213 389.14 198.333L385.822 184.975C379.709 160.368 365.947 138.335 346.516 122.047C329.956 108.166 309.951 99.0222 288.618 95.584L273.414 93.1336C256.429 90.3961 239.111 90.4408 222.14 93.266L215.778 94.325C190.227 98.5785 166.415 110.019 147.128 127.31C125.005 147.141 109.942 173.758 104.266 202.92C100.798 220.735 100.895 239.125 104.574 256.897Z" stroke="#2C0F52" stroke-width="10"/>
        </g>
        <g filter="url(#filter4_i_44_62)">
        <path d="M195.63 197.917C216.158 204.133 226.466 229.791 218.79 255.145C211.114 280.498 188.304 296.13 167.776 289.914C147.247 283.699 136.939 258.04 144.615 232.687C152.292 207.333 175.101 191.702 195.63 197.917Z" fill="#2C0F52"/>
        <path d="M293.776 197.917C273.247 204.133 262.939 229.791 270.615 255.145C278.291 280.498 301.101 296.13 321.63 289.914C342.158 283.699 352.466 258.04 344.79 232.687C337.114 207.333 314.304 191.702 293.776 197.917Z" fill="#2C0F52"/>
        <path d="M239.472 286.491C241.721 284.349 245.263 284.371 247.486 286.54L260.701 299.432C262.971 301.646 264.25 304.683 264.25 307.854V310.719C264.25 313.99 262.187 316.905 259.103 317.993C256.813 318.801 254.276 318.485 252.256 317.138L248.048 314.332C245.273 312.482 241.674 312.417 238.834 314.165L233.644 317.359C231.677 318.569 229.262 318.803 227.101 317.992C224.183 316.898 222.25 314.109 222.25 310.993V307.968L222.254 307.664C222.334 304.534 223.652 301.559 225.925 299.394L239.472 286.491Z" fill="#2C0F52"/>
        </g>
        </g>
        <ellipse cx="323.453" cy="140.845" rx="6.66313" ry="22.4582" transform="rotate(-53.7586 323.453 140.845)" fill="#D9D9D9"/>
        <ellipse cx="363.765" cy="60.5" rx="12.0133" ry="31.8188" transform="rotate(-53.7586 363.765 60.5)" fill="#D9D9D9"/>
        </g>
        <defs>
        <filter id="filter0_ii_44_62" x="-25.8" y="-40.6" width="552.8" height="562.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
        <feFlood flood-opacity="0" result="BackgroundImageFix"/>
        <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dx="31" dy="-74"/>
        <feGaussianBlur stdDeviation="20.3"/>
        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
        <feBlend mode="normal" in2="shape" result="effect1_innerShadow_44_62"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dx="-48" dy="66"/>
        <feGaussianBlur stdDeviation="12.9"/>
        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
        <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0"/>
        <feBlend mode="normal" in2="effect1_innerShadow_44_62" result="effect2_innerShadow_44_62"/>
        </filter>
        <filter id="filter1_ddi_44_62" x="35.3" y="39" width="420.7" height="421.7" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
        <feFlood flood-opacity="0" result="BackgroundImageFix"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dx="-7" dy="11"/>
        <feComposite in2="hardAlpha" operator="out"/>
        <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0"/>
        <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_44_62"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dx="9" dy="-9"/>
        <feComposite in2="hardAlpha" operator="out"/>
        <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0"/>
        <feBlend mode="normal" in2="effect1_dropShadow_44_62" result="effect2_dropShadow_44_62"/>
        <feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_44_62" result="shape"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dx="-17" dy="33"/>
        <feGaussianBlur stdDeviation="6.35"/>
        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
        <feBlend mode="normal" in2="shape" result="effect3_innerShadow_44_62"/>
        </filter>
        <filter id="filter2_i_44_62" x="96.7375" y="81.1133" width="302.136" height="323.887" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
        <feFlood flood-opacity="0" result="BackgroundImageFix"/>
        <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dy="-20"/>
        <feGaussianBlur stdDeviation="2.5"/>
        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.39 0"/>
        <feBlend mode="normal" in2="shape" result="effect1_innerShadow_44_62"/>
        </filter>
        <filter id="filter3_di_44_62" x="79.8375" y="86.1133" width="319.036" height="335.787" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
        <feFlood flood-opacity="0" result="BackgroundImageFix"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dx="-11" dy="11"/>
        <feGaussianBlur stdDeviation="2.95"/>
        <feComposite in2="hardAlpha" operator="out"/>
        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
        <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_44_62"/>
        <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_44_62" result="shape"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dx="-13" dy="16"/>
        <feGaussianBlur stdDeviation="1.65"/>
        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.49 0"/>
        <feBlend mode="normal" in2="shape" result="effect2_innerShadow_44_62"/>
        </filter>
        <filter id="filter4_i_44_62" x="136.928" y="196.303" width="210.649" height="127.316" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
        <feFlood flood-opacity="0" result="BackgroundImageFix"/>
        <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>
        <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
        <feOffset dx="-23" dy="10"/>
        <feGaussianBlur stdDeviation="2.45"/>
        <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
        <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
        <feBlend mode="normal" in2="shape" result="effect1_innerShadow_44_62"/>
        </filter>
        <clipPath id="clip0_44_62">
        <rect width="496" height="496" fill="white"/>
        </clipPath>
        <linearGradient id="innerContour" x1="120" y1="120" x2="360" y2="360" gradientUnits="userSpaceOnUse">
          <stop offset="0%" stop-color="#C38BFF" stop-opacity="0.95"/>
          <stop offset="45%" stop-color="#A162F6" stop-opacity="0.9"/>
          <stop offset="100%" stop-color="#7A2BCC" stop-opacity="0.75"/>
        </linearGradient>
        </defs>
        </svg>
    </div>

    <div class="redemption-text">
      <div class="redemption-user" id="redemption-user"></div>
      <div class="redemption-reward" id="redemption-reward"></div>
    </div>
  </div>

  <script>
    const RENDER_URL = 'https://tattoostwitch327.onrender.com';

    // Listen for channel points events
    const cpEventSource = new EventSource(RENDER_URL + '/channel-points-events');
    cpEventSource.onmessage = (event) => {
      try {
        const data = JSON.parse(event.data);
        console.log('[CP] Received channel points event:', data);
        triggerChannelPointsAlert(data.username, data.reward);
      } catch (e) {
        console.error('[CP] Failed to parse event:', e);
      }
    };

    function triggerChannelPointsAlert(username, rewardName) {
      const alert = document.getElementById('coin-alert');
      const userEl = document.getElementById('redemption-user');
      const rewardEl = document.getElementById('redemption-reward');

      userEl.textContent = username;
      rewardEl.textContent = rewardName;

      alert.classList.remove('exit');
      alert.classList.add('active');

      // Remove after 4 seconds
      setTimeout(() => {
        alert.classList.remove('active');
        alert.classList.add('exit');

        setTimeout(() => {
          alert.classList.remove('exit');
        }, 500);
      }, 4000);
    }

    // Test function (can be called from console)
    window.testChannelPoints = (username = 'TestUser', reward = 'Hydrate Reminder') => {
      triggerChannelPointsAlert(username, reward);
    };

    console.log('[CHANNEL POINTS] Listening for redemptions...');
    console.log('[CHANNEL POINTS] Test with: testChannelPoints("Username", "Reward Name")');
  </script>
</body>
</html>
